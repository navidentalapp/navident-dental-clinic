# Production Configuration for MongoDB Atlas and Render Deployment

# ======================================
# MONGODB ATLAS CONFIGURATION
# ======================================
spring.data.mongodb.uri=${MONGODB_URI}
spring.data.mongodb.database=navident_clinic

# Alternative configuration (use this if above doesn't work)
# spring.data.mongodb.host=${MONGO_HOST}
# spring.data.mongodb.port=${MONGO_PORT:27017}
# spring.data.mongodb.database=navident_clinic
# spring.data.mongodb.username=${MONGO_USERNAME}
# spring.data.mongodb.password=${MONGO_PASSWORD}

# ======================================
# SERVER CONFIGURATION
# ======================================
server.port=${PORT:8080}
server.servlet.context-path=
server.compression.enabled=true
server.http2.enabled=true

# ======================================
# JWT SECURITY CONFIGURATION
# ======================================
app.jwt.secret=${JWT_SECRET}
app.jwt.expiration-ms=86400000

# ======================================
# ADMIN USER CONFIGURATION
# ======================================
app.admin.username=${ADMIN_USERNAME:admin}
app.admin.password=${ADMIN_PASSWORD}
app.admin.email=${ADMIN_EMAIL:admin@navident.com}
app.admin.firstName=${ADMIN_FIRSTNAME:System}
app.admin.lastName=${ADMIN_LASTNAME:Administrator}

# ======================================
# CORS CONFIGURATION
# ======================================
app.cors.allowed-origins=${FRONTEND_URL:http://localhost:3000}
app.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS,PATCH
app.cors.allowed-headers=*
app.cors.exposed-headers=*
app.cors.allow-credentials=true
app.cors.max-age=3600

# ======================================
# SPRING CONFIGURATION
# ======================================
spring.main.allow-bean-definition-overriding=true
spring.jackson.time-zone=UTC
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss

# Disable embedded MongoDB completely
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration

# ======================================
# ACTUATOR (HEALTH CHECK)
# ======================================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.health.mongo.enabled=true

# ======================================
# LOGGING CONFIGURATION
# ======================================
logging.level.com.navident.clinic=INFO
logging.level.org.springframework.data.mongodb=INFO
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=INFO
logging.level.root=WARN

# Console logging pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} %5p --- [%15.15t] %-40.40logger{39} : %m%n

# ======================================
# SPRING DATA MONGODB
# ======================================
spring.data.mongodb.auto-index-creation=true

# Connection pool settings
spring.data.mongodb.option.max-connection-pool-size=50
spring.data.mongodb.option.min-connection-pool-size=5
spring.data.mongodb.option.max-connection-idle-time=30000
spring.data.mongodb.option.max-connection-life-time=120000
spring.data.mongodb.option.connection-timeout=10000
spring.data.mongodb.option.socket-timeout=10000
spring.data.mongodb.option.server-selection-timeout=10000

# ======================================
# MULTIPART FILE UPLOAD
# ======================================
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ======================================
# ERROR HANDLING
# ======================================
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on-param
server.error.include-exception=false